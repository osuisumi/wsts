$(document).ready(function(){activityJs.fn.init()});var activityJs=$(window).activityJs||{};activityJs.fn={init:function(){this.set_tag();this.high_options();this.drop_down_box();this.countDown();this.commentOpa(".am-comment-box");this.commentOpa(".am-isComment-box");this.commentShow()},set_tag:function(){$(".am-add-tag").each(function(){var a=$(this);$ipt_parents=a.find(".am-tagipt");$ipt=$ipt_parents.find(".au-ipt");$hint_lst=$ipt_parents.find(".l-slt-lst");$add_btn=a.find(".au-add-tag");$tag_lst=a.find(".am-tag-lst");activityJs.fn.tag_hint_show($ipt,$hint_lst);activityJs.fn.add_tag($ipt,$add_btn,$tag_lst);activityJs.fn.delete_tag($tag_lst)})},tag_hint_show:function(a,b){a.on("focus",function(){""==!$(this).val()&&b.show()});a.on("keyup",function(){""==!$(this).val()?b.show():b.hide()});this.tag_hint_hide(a,b)},tag_hint_hide:function(a,b){$(document).on("click",function(c){c=$(c.target);0==c.closest(b).length&&0==c.closest(a).length&&b.hide()});b.on("click","a",function(){b.hide();a.val($(this).text())})},add_tag:function(a,b,c){b.on("click",function(){var b=!1,e=c.children().length;if(""!=a.val()){for(var f=0;f<e;f++)a.val()==c.children().eq(f).find(".txt").text()&&(alert("\u5df2\u6709\u76f8\u540c\u6807\u7b7e"),a.val(""),a.focus(),b=!0);b||(c.append('\x3cli\x3e\x3cspan class\x3d"txt"\x3e'+a.val()+'\x3c/span\x3e\x3ca href\x3d"javascript:void(0);" class\x3d"dlt" title\x3d"\u5220\u9664\u6807\u7b7e"\x3e\u00d7\x3c/a\x3e\x3c/li\x3e'),a.val(""))}})},delete_tag:function(a){a.on("click",".dlt",function(){$(this).parent().remove()})},high_options:function(){var a=$(".ag-high-options"),b=a.find(".au-high-option"),c=a.find(".ag-high-lst");b.on("click",function(){_ts=$(this);_ts.hasClass("z-crt")?(_ts.removeClass("z-crt"),c.hide()):(_ts.addClass("z-crt"),c.show())})},drop_down_box:function(){$(".am-slt-lst").each(function(){var a=$(this),b=a.children(".show"),c=b.children(".txt"),d=a.children(".lst");d.children("a");b.on("click",function(){var e=$(this);e.hasClass("z-crt")?(d.hide(),e.removeClass("z-crt")):(d.show(),e.addClass("z-crt"));$(document).on("click",function(c){0==$(c.target).closest(a).length&&(d.hide(),b.removeClass("z-crt"))});a.on("click",".lst a",function(){d.hide();b.removeClass("z-crt");c.text($(this).text());$(this).addClass("z-crt").siblings().removeClass("z-crt")})})})},countDown:function(){var a=$(".am-count-down"),b=a.find(".endTime"),c=a.find(".day"),d=a.find(".hour"),e=a.find(".minute"),f=a.find(".second"),l=new Date(b.val()),a=new Date,a=parseInt((l.getTime()-a.getTime())/1E3),b=parseInt(a/86400),g=parseInt(a/3600%24),h=parseInt(a/60%60),k=parseInt(a%60);c.text(b);d.text(g);e.text(h);f.text(k);10>b&&c.text("0"+b);10>g&&d.text("0"+g);10>h&&e.text("0"+h);10>k&&f.text("0"+k);1>a&&(clearTimeout(m),c.text("00"),d.text("00"),e.text("00"),f.text("00"));var m=setInterval(function(){var a=new Date,a=parseInt((l.getTime()-a.getTime())/1E3),b=parseInt(a/86400),g=parseInt(a/3600%24),h=parseInt(a/60%60),k=parseInt(a%60);c.text(b);d.text(g);e.text(h);f.text(k);10>b&&c.text("0"+b);10>g&&d.text("0"+g);10>h&&e.text("0"+h);10>k&&f.text("0"+k);1>a&&(clearTimeout(m),c.text("00"),d.text("00"),e.text("00"),f.text("00"))},1E3)},commentOpa:function(a){$(a+" .au-textarea").on("focus",function(){var b=$(this),c=b.parents(a),d=c.find(".comment-placeholder"),e=c.find(".am-cmtBtn-block");c.find(".au-face");c.find(".au-cmtPublish-btn");d.stop().animate({opacity:"0"},200,function(){$(this).hide()});b.stop().animate({height:"76px"},200,function(){e.show()});$(document).on("click",function(c){0==$(c.target).closest(a).length&&""==b.val()&&(d.stop().animate({opacity:"1"},200,function(){$(this).show()}),b.stop().animate({height:"22px"},100,function(){e.hide()}))})})},commentShow:function(){var a=$(".ag-cmt-lst-p").children("li"),b=a.find(".au-comment"),c=a.find(".ag-is-comment");a.each(function(){var a=$(this),e=a.find(".au-comment"),f=a.find(".ag-is-comment");f.innerHeight();e.on("click",function(){var a=$(this).closest("ul").attr("relationId"),d=$(this).closest("li").attr("commentId"),e=$("#"+d+"_childComment");0>=e.find("li").size()&&e.load($("#ctx").val()+"/comment/activity/child","mainId\x3d"+d+"\x26relationId\x3d"+a);a=$(this);a.hasClass("z-crt")?(a.removeClass("z-crt"),f.hide()):(c.hide(),b.removeClass("z-crt"),a.addClass("z-crt"),f.find(".au-comment-trg").css("left",Math.ceil(a.position().left)-25),f.show())})})},aJumpLayer:function(a){a=$(a);var b=a.innerWidth(),c=a.innerHeight();a.show().css({"margin-top":-c/2+"px","margin-left":-b/2+"px"});$(".ag-blackbg").show().css("opacity","0.5");a.find(".au-confirm-btn").bind("click",function(){a.hide();$(".ag-blackbg").hide().css("opacity","1")});a.find(".au-cancel-btn").bind("click",function(){a.hide();$(".ag-blackbg").hide().css("opacity","1")});a.find(".au-close-btn").bind("click",function(){a.hide();$(".ag-blackbg").hide().css("opacity","1")})},openABlayer:function(a){a=$(a);var b=$(".ag-whitebg"),c=$(window).scrollTop();a.show().css("top",c+100+"px");b.show();this.closeABlayer(a,b)},closeABlayer:function(a,b){var c=a.find(".au-closelayer-ico"),d=a.find(".au-cancel-btm");c.on("click",function(){a.hide();b.hide()});d.on("click",function(){a.hide();b.hide()})}};$.fn.extend({myTab:function(a){a=$.extend({pars:".myTab",tabNav:".tabNav",li:"li",tabCon:".tabCon",tabList:".tabList",cur:"cur",eType:"click",page:0},a);var b=$(this),c=b.find(a.tabNav).find(a.li);tabList=b.find(a.tabCon).find(a.tabList);this.each(function(){c.removeClass(a.cur);c.eq(a.page).addClass(a.cur);tabList.hide();tabList.eq(a.page).show();c.eq(a.page).show();c.on(a.eType,function(){var b=$(this).parents(a.tabNav).find(a.li).index(this);$(this).addClass(a.cur).siblings().removeClass(a.cur);$(this).parents(a.pars).find(a.tabCon).find(a.tabList).eq(b).css({display:"block"}).siblings().css({display:"none"})})});return this}});